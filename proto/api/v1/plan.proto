syntax = "proto3";

package api.v1;

option go_package = "github.com/loomi-labs/arco/backend/api/v1;arcov1";

// PlanService provides public access to subscription plan information.
//
// This service is publicly accessible and does not require authentication.
// It returns available subscription plans sourced with USD pricing.
//
// The service integrates with Polar for payment processing and provides
// pricing information needed for checkout session creation.
service PlanService {
  // ListPlans returns all available subscription plans with USD pricing.
  //
  // This endpoint is publicly accessible and returns all available plans
  // with their respective storage limits, repository limits, and USD pricing.
  //
  // Plans include overage pricing for storage beyond the base limit,
  // charged per GB of additional usage.
  rpc ListPlans(ListPlansRequest) returns (ListPlansResponse) {}
}

// ListPlansRequest initiates retrieval of all available subscription plans.
//
// This request requires no parameters as it returns all publicly available
// plan information.
message ListPlansRequest {
}

// ListPlansResponse contains all available subscription plans.
//
// Returns all available plans (Lite, Pro, Max) with complete pricing
// information for USD pricing and yearly billing cycles.
message ListPlansResponse {
  // All available subscription plans with USD pricing.
  repeated Plan plans = 1;
}


// Plan represents a complete subscription plan with pricing and features.
//
// Each plan is sourced from Polar products and contains all necessary
// information for displaying plans and handling subscriptions.
message Plan {
  // ID is the product ID of Polar used for checkout sessions and subscriptions
  string id = 1;

  // Human-readable plan name (e.g., "Arco Cloud - Lite", "Arco Cloud - Pro").
  string name = 2;
  
  // Plan description with storage and pricing details.
  string description = 3;
  
  // Base storage limit in GB included in the plan.
  int64 storage_gb = 4;
  
  // Maximum number of repositories allowed for this plan.
  int32 allowed_repositories = 5;
  
  // Whether this plan should be highlighted as popular/recommended.
  bool popular = 6;
  
  // Base yearly subscription price in cents (e.g., 2400 = $24.00).
  int64 price_cents = 7;
  
  // Overage pricing per GB in cents for usage beyond base storage limit.
  int64 overage_per_gb_cents = 8;
}